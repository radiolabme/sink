{
  "$schema": "../src/sink.schema.json",
  "version": "1.0.0",
  "description": "Test retry in remediation steps",
  "platforms": [
    {
      "os": "darwin",
      "match": "darwin*",
      "name": "macOS (Remediation Retry)",
      "install_steps": [
        {
          "name": "Check for delayed file",
          "check": "test -f /tmp/sink-remediation-test",
          "on_missing": [
            {
              "name": "Create file after delay",
              "command": "(sleep 1 && touch /tmp/sink-remediation-test) &"
            },
            {
              "name": "Wait for file creation",
              "command": "test -f /tmp/sink-remediation-test",
              "retry": "until",
              "timeout": "5s"
            }
          ]
        },
        {
          "name": "Cleanup",
          "command": "rm -f /tmp/sink-remediation-test"
        }
      ]
    }
  ]
}
