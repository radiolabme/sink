{
  "$schema": "../src/sink.schema.json",
  "description": "Conditional execution with check/on_missing pattern",
  "version": "1.0.0",
  "platforms": [
    {
      "os": "darwin",
      "match": "darwin*",
      "name": "macOS",
      "install_steps": [
        {
          "name": "Check if Homebrew is installed",
          "check": "command -v brew",
          "on_missing": [
            {
              "name": "Install Homebrew",
              "command": "/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\""
            },
            {
              "name": "Add Homebrew to PATH",
              "command": "echo 'eval \"$(/opt/homebrew/bin/brew shellenv)\"' >> ~/.zprofile"
            }
          ]
        },
        {
          "name": "Check if jq is installed",
          "check": "command -v jq",
          "on_missing": [
            {
              "name": "Install jq via Homebrew",
              "command": "brew install jq"
            }
          ]
        },
        {
          "name": "Verify jq works",
          "command": "jq --version"
        }
      ]
    }
  ]
}
